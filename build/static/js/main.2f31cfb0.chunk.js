(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[3],{12:function(e,t,r){"use strict";var n=r(54),a=r.n(n).a.create({baseURL:"https://immersiv.herokuapp.com/api",withCredentials:!0});a.interceptors.request.use((function(e){var t=JSON.parse(localStorage.getItem("token"));return t&&(e.headers["auth-token"]=t),e}),(function(e){return Promise.reject(e)})),t.a=a},14:function(e,t,r){"use strict";var n=r(3),a=r.n(n),s=r(8),c=r(34),i=r(35),o=r(12),l=function(){function e(){Object(c.a)(this,e)}return Object(i.a)(e,[{key:"login",value:function(){var e=Object(s.a)(a.a.mark((function e(t,r){var n,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.post("/auth/login",{email:t,password:r});case 2:return n=e.sent,s=n.data,e.abrupt("return",s);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"googleLogin",value:function(){var e=Object(s.a)(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.post("/auth/google",{token:t});case 2:return r=e.sent,n=r.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"logout",value:function(){localStorage.removeItem("user"),localStorage.removeItem("token"),localStorage.removeItem("expiresAt")}},{key:"forgotPassword",value:function(e){return o.a.post("/auth/forgot-password",{email:e})}},{key:"checkToken",value:function(e,t){return o.a.post("auth/check-token",{token:e,email:t})}},{key:"resetPassword",value:function(e,t,r,n){return o.a.post("auth/reset-password",{token:e,email:t,password:r,password2:n})}},{key:"register",value:function(e,t,r){return o.a.post("auth/signup",{username:e,email:t,password:r})}},{key:"getCurrentUser",value:function(){return o.a.get("/users/profile")}}]),e}();t.a=new l},15:function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return p}));var n=r(1),a=r(7),s=r(3),c=r.n(s),i=r(8),o=r(0),l=r(12),u=r(19),d=function(e){var t=e.children,r=p(),n=r.setIsLoggedIn,a=r.setUserData,s=r.setAuthData,d=r.isLoggedIn;return Object(o.useMemo)((function(){d&&l.a.interceptors.response.use((function(e){return e}),function(){var e=Object(i.a)(c.a.mark((function e(t){var r,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.config,401!==t.response.status||"/auth/refresh-token"!==r.url){e.next=3;break}return e.abrupt("return",new Promise((function(e,r){n(!1),s(null),a(null),u.a.push("/login"),r(t)})));case 3:if(401!==t.response.status||r._retry){e.next=20;break}return e.prev=4,r._retry=!0,e.next=8,l.a.post("/auth/refresh-token");case 8:return i=e.sent,localStorage.setItem("token",JSON.stringify(i.data.token)),e.abrupt("return",Object(l.a)(r));case 13:e.prev=13,e.t0=e.catch(4),localStorage.removeItem("token"),n(!1),s(null),a(null),u.a.push("/login");case 20:return e.abrupt("return",Promise.reject(t));case 21:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}())}),[d,s,n,a]),t},j=r(14),b=Object(o.createContext)(),m=function(e){var t=e.children,r=Object(o.useState)({token:""}),s=Object(a.a)(r,2),c=s[0],i=s[1],l=Object(o.useState)(!1),u=Object(a.a)(l,2),m=u[0],p=u[1];Object(o.useEffect)((function(){localStorage.getItem("token")&&(p(!0),i(JSON.parse(localStorage.getItem("token"))))}),[]);return Object(n.jsx)(b.Provider,{value:{setUserState:function(e){return function(e){var t=e.token;p(!0),i({token:t}),localStorage.setItem("token",JSON.stringify(t))}(e)},logout:function(){i(null),p(!1),j.a.logout()},isLoggedIn:m,setIsLoggedIn:p,authData:c,setAuthData:i},children:Object(n.jsx)(d,{children:t})})},p=function(){var e=Object(o.useContext)(b);if(void 0===e)throw new Error("useUser must be used within UserProvider");return e}},19:function(e,t,r){"use strict";var n=r(55);t.a=Object(n.a)()},20:function(e,t,r){"use strict";var n=r(1),a=r(26),s=(r(0),r(25));t.a=function(e){var t=e.children,r=e.title,c=e.loading,i=e.description;return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)(s.a,{children:[Object(n.jsxs)("title",{children:[r||"Home"," | IMMERSIV "]}),Object(n.jsx)("meta",{name:"description",content:i||"Ecommerce store built with React, Node, Express and Postgres"})]}),c?Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(a.a,{size:100,loading:!0})}):Object(n.jsx)("div",{style:{flex:1},children:t})]})}},26:function(e,t,r){"use strict";var n=r(1),a=(r(0),r(58)),s=r.n(a);t.a=function(e){var t=e.css,r=e.size,a=e.loading;return Object(n.jsx)("div",{className:"absolute transform -translate-x-2/4 -translate-y-2/4 left-2/4 top-2/4",children:Object(n.jsx)(s.a,{css:t,size:r,color:"#123abc",loading:a})})}},95:function(e,t,r){},96:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(15),s=r(0),c=r(28),i=r.n(c),o=r(25),l=r(26),u=r(19),d=r(20),j=r(3),b=r.n(j),m=r(8),p=r(7),h=r(4),x=r(16),O=r(14),f=r(21),g=r.n(f),v=r(22),w=function(){var e=Object(s.useState)(!1),t=Object(p.a)(e,2),r=t[0],a=t[1],c=Object(s.useState)(""),i=Object(p.a)(c,2),o=i[0],l=i[1],u=Object(s.useState)(!1),d=Object(p.a)(u,2),j=d[0],b=d[1],m=Object(v.a)(),f=m.handleSubmit,w=m.register,k=m.errors,y=function(e){l(""),b(!0),O.a.forgotPassword(e.email).then((function(e){"OK"===e.data.status&&(b(!1),x.b.success("Email has been sent successfully."),a(!1))})).catch((function(e){b(!1),l(e.response.data.message)}))};return Object(n.jsx)("div",{children:Object(n.jsxs)(n.Fragment,{children:[r&&Object(n.jsx)(h.Backdrop,{}),Object(n.jsx)("span",{onClick:function(){return a(!r)},className:"mb-1 text-sm text-purple-700 cursor-pointer",children:"Forgot password?"}),Object(n.jsx)(h.Modal,{isOpen:r,onClose:function(){l(""),a(!r)},children:Object(n.jsxs)("form",{onSubmit:f(y),children:[Object(n.jsx)(h.ModalHeader,{children:"Forgot Password"}),Object(n.jsxs)(h.ModalBody,{children:[Object(n.jsxs)(h.Label,{children:[Object(n.jsx)("span",{className:"font-semibold",children:"Email"}),Object(n.jsx)(h.Input,{name:"email",className:"mt-1 border py-2 pl-2",valid:!0,type:"email",inputMode:"email",ref:w({required:"Email required",pattern:{value:/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/,message:"Email not valid"}})})]}),k.email&&"required"===k.email.type&&Object(n.jsx)(h.HelperText,{className:"mt-2",valid:!1,children:k.email.message}),k.email&&"pattern"===k.email.type&&Object(n.jsx)(h.HelperText,{className:"mt-2",valid:!1,children:k.email.message}),o&&Object(n.jsx)(h.HelperText,{className:"mt-2",valid:!1,children:o}),Object(n.jsx)(h.HelperText,{className:"mt-2",valid:!1,children:"Don't forget to check your spam folder!"})]}),Object(n.jsx)(h.ModalFooter,{children:Object(n.jsx)(h.Button,{onClick:f(y),disabled:j,className:"w-full sm:w-auto",children:j?Object(n.jsx)(g.a,{size:10,color:"#0a138b"}):"Send email"})})]})})]})})},k=r(97),y=function(){var e=Object(a.b)(),t=e.isLoggedIn,r=e.setUserState,c=Object(s.useState)(""),i=Object(p.a)(c,2),o=i[0],l=i[1],u=Object(s.useState)(!1),j=Object(p.a)(u,2),f=j[0],y=j[1],S=Object(s.useState)(!1),N=Object(p.a)(S,2),I=N[0],P=N[1],L=Object(v.a)(),E=L.register,F=L.handleSubmit,T=L.errors,q=function(){var e=Object(m.a)(b.a.mark((function e(t){var n,a,s,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,a=t.password,e.prev=1,l(""),y(!0),e.next=6,O.a.login(n,a);case 6:s=e.sent,x.b.success("Login successful \ud83d\udd13"),setTimeout((function(){r(s),P(!0),y(!1)}),1500),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),y(!1),l(null===(c=e.t0.response)||void 0===c?void 0:c.data.message);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return I||t?Object(n.jsx)(k.a,{to:"/admin"}):Object(n.jsx)(d.a,{title:"Login",children:Object(n.jsx)("div",{className:"flex items-center justify-center m-auto mt-20",children:Object(n.jsxs)("form",{className:"bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4 flex flex-col w-full md:w-1/2",onSubmit:F(q),children:[Object(n.jsx)("h1",{className:"text-center text-4xl my-4",children:"Manage projects"}),Object(n.jsxs)("div",{className:"",children:[Object(n.jsx)(h.Label,{className:"block text-grey-darker text-sm font-bold mb-2",children:Object(n.jsx)("span",{children:"Email"})}),Object(n.jsx)(h.Input,{className:"shadow appearance-none border rounded w-full py-2 px-3 text-grey-darker",type:"email",name:"email",ref:E({required:!0,pattern:/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/}),placeholder:"Enter a valid email"})]}),T.email&&"required"===T.email.type&&Object(n.jsx)(h.HelperText,{className:"mt-1 italic",valid:!1,children:"Email required"}),T.email&&"pattern"===T.email.type&&Object(n.jsx)(h.HelperText,{className:"mt-1 italic",valid:!1,children:"Invalid email"}),Object(n.jsxs)("div",{className:"mt-4",children:[Object(n.jsx)(h.Label,{className:"block text-grey-darker text-sm font-bold mb-2",children:Object(n.jsx)("span",{children:"Password"})}),Object(n.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-grey-darker",type:"password",name:"password",ref:E({required:!0})})]}),T.password&&"required"===T.password.type&&Object(n.jsx)(h.HelperText,{className:"mt-1 italic",valid:!1,children:"Password required"}),o&&Object(n.jsx)(h.HelperText,{className:"mt-1 italic",valid:!1,children:o}),Object(n.jsx)("div",{className:"mt-4",children:Object(n.jsx)(w,{})}),Object(n.jsx)(h.Button,{type:"submit",disabled:f,children:f?Object(n.jsx)(g.a,{color:"#0a138b",size:10,loading:f}):"Login"})]})})})},S=r(27),N=r(60),I=function(e){var t=e.children,r=Object(N.a)(e,["children"]),s=Object(a.b)().isLoggedIn;return Object(n.jsx)(k.b,Object(S.a)(Object(S.a)({},r),{},{render:function(e){var r=e.location;return s?t:Object(n.jsx)(k.a,{to:{pathname:"/login",state:{from:r}}})}}))},P=Object(s.lazy)((function(){return Promise.all([r.e(0),r.e(1),r.e(2),r.e(8)]).then(r.bind(null,1028))})),L=Object(s.lazy)((function(){return Promise.all([r.e(0),r.e(1),r.e(2)]).then(r.bind(null,991))})),E=Object(s.lazy)((function(){return Promise.all([r.e(0),r.e(6),r.e(7)]).then(r.bind(null,1061))})),F=Object(s.lazy)((function(){return r.e(9).then(r.bind(null,1068))}));var T=function(){return Object(n.jsx)(k.c,{history:u.a,children:Object(n.jsx)(s.Suspense,{fallback:Object(n.jsx)(d.a,{children:Object(n.jsx)(l.a,{size:100})}),children:Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(x.a,{position:"top-right"}),Object(n.jsxs)(k.d,{children:[Object(n.jsx)(k.b,{exact:!0,path:"/",children:Object(n.jsx)(P,{})}),Object(n.jsx)(k.b,{path:"/login",children:Object(n.jsx)(y,{})}),Object(n.jsx)(I,{exact:!0,path:"/admin",children:Object(n.jsx)(E,{})}),Object(n.jsx)(k.b,{path:"/reset-password",children:Object(n.jsx)(F,{})}),Object(n.jsx)(k.b,{exact:!0,path:"/:id/",children:Object(n.jsx)(L,{})}),Object(n.jsx)(k.b,{path:"*",children:Object(n.jsx)("h1",{children:"404 Error Found"})})]})]})})})},q=function(e){e&&e instanceof Function&&r.e(10).then(r.bind(null,1057)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,s=t.getLCP,c=t.getTTFB;r(e),n(e),a(e),s(e),c(e)}))};r(95);i.a.render(Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(o.b,{children:Object(n.jsx)(a.a,{children:Object(n.jsx)(T,{})})})}),document.getElementById("root")),q()}},[[96,4,5]]]);
//# sourceMappingURL=main.2f31cfb0.chunk.js.map