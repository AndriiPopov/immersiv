(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[3],{163:function(e,t,n){"use strict";n(6),n(400),n(402),n(0)},399:function(e,t,n){"use strict";n.r(t);var r=n(6),a=n(70),s=n(0),c=n(30),i=n.n(c),o=n(104),u=(n(163),n(81)),l=n(88),j=n(44),b=n.n(j),d=n(59),h=n(47),p=n(71),m=n(69),f=n(210),O=n.n(f),x=n(411),g=n(412),v=n(216),k=n(416),y=function(){var e=Object(s.useState)(!1),t=Object(h.a)(e,2),n=t[0],a=t[1];return Object(r.jsx)("div",{children:Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("span",{onClick:function(){return a(!n)},children:"Forgot password?"}),Object(r.jsx)(O.a,{title:"Forgot Password",visible:n,footer:[],onCancel:function(){return a(!1)},children:Object(r.jsxs)(x.a,{name:"normal_login",onFinish:function(e){m.a.forgotPassword(e.email).then((function(e){"OK"===e.data.status&&(p.b.success("Email has been sent successfully."),a(!1))})).catch((function(e){}))},style:{padding:"100px 16px",maxWidth:"500px",margin:"auto"},children:[Object(r.jsx)(x.a.Item,{name:"email",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your E-mail!"}],children:Object(r.jsx)(g.a,{prefix:Object(r.jsx)(k.a,{className:"site-form-item-icon"}),placeholder:"Email"})}),Object(r.jsx)(x.a.Item,{children:Object(r.jsx)(v.a,{type:"primary",htmlType:"submit",style:{width:"100%"},children:"Reset password"})})]})})]})})},w=n(415),I=n(402),S=n(417),P=function(){var e=Object(a.b)(),t=e.isLoggedIn,n=e.setUserState,c=Object(s.useState)(!1),i=Object(h.a)(c,2),o=i[0],u=i[1],j=Object(s.useState)(!1),f=Object(h.a)(j,2),O=f[0],P=f[1],E=function(){var e=Object(d.a)(b.a.mark((function e(t){var r,a,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.email,a=t.password,e.prev=1,u(!0),e.next=5,m.a.login(r,a);case 5:s=e.sent,p.b.success("Login successful \ud83d\udd13"),setTimeout((function(){n(s),P(!0),u(!1)}),1500),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),u(!1);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return O||t?Object(r.jsx)(w.a,{to:"/admin"}):Object(r.jsx)(l.a,{title:"Login",loading:o,children:Object(r.jsxs)(x.a,{name:"normal_login",onFinish:E,style:{padding:"100px 16px",maxWidth:"500px",margin:"auto"},children:[Object(r.jsx)(I.a.Title,{style:{textAlign:"center",marginBottom:"50px"},children:"Manage IMMERSIVE"}),Object(r.jsx)(x.a.Item,{name:"email",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your E-mail!"}],children:Object(r.jsx)(g.a,{prefix:Object(r.jsx)(k.a,{className:"site-form-item-icon"}),placeholder:"Email"})}),Object(r.jsx)(x.a.Item,{name:"password",rules:[{required:!0,message:"Please input your Password!"}],children:Object(r.jsx)(g.a.Password,{prefix:Object(r.jsx)(S.a,{className:"site-form-item-icon"}),type:"password",placeholder:"Password"})}),Object(r.jsx)(x.a.Item,{children:Object(r.jsx)("a",{children:Object(r.jsx)(y,{})})}),Object(r.jsx)(x.a.Item,{children:Object(r.jsx)(v.a,{type:"primary",htmlType:"submit",style:{width:"100%"},children:"Log in"})})]})})},E=n(123),L=n(220),F=function(e){var t=e.children,n=Object(L.a)(e,["children"]),s=Object(a.b)().isLoggedIn;return Object(r.jsx)(w.b,Object(E.a)(Object(E.a)({},n),{},{render:function(e){var n=e.location;return s?t:Object(r.jsx)(w.a,{to:{pathname:"/login",state:{from:n}}})}}))},C=Object(s.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(8)]).then(n.bind(null,1298))})),T=Object(s.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2)]).then(n.bind(null,1260))})),N=Object(s.lazy)((function(){return Promise.all([n.e(0),n.e(6),n.e(7)]).then(n.bind(null,1326))})),U=Object(s.lazy)((function(){return n.e(9).then(n.bind(null,1331))}));var J=function(){return Object(r.jsx)(w.c,{history:u.a,children:Object(r.jsx)(s.Suspense,{fallback:Object(r.jsx)(l.a,{}),children:Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(p.a,{position:"top-right"}),Object(r.jsxs)(w.d,{children:[Object(r.jsx)(w.b,{exact:!0,path:"/",children:Object(r.jsx)(C,{})}),Object(r.jsx)(w.b,{path:"/login",children:Object(r.jsx)(P,{})}),Object(r.jsx)(F,{exact:!0,path:"/admin",children:Object(r.jsx)(N,{})}),Object(r.jsx)(w.b,{path:"/reset-password",children:Object(r.jsx)(U,{})}),Object(r.jsx)(w.b,{exact:!0,path:"/p/:id",children:Object(r.jsx)(T,{})}),Object(r.jsx)(w.b,{path:"*",children:Object(r.jsx)("h1",{children:"404 Error Found"})})]})]})})})},M=function(e){e&&e instanceof Function&&n.e(10).then(n.bind(null,1322)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),s(e),c(e)}))},D=(n(397),n(414)),R=n(407),q=Object(R.a)();i.a.render(Object(r.jsx)(D.a,{theme:q,children:Object(r.jsx)(o.b,{children:Object(r.jsx)(a.a,{children:Object(r.jsx)(J,{})})})}),document.getElementById("root")),M()},43:function(e,t,n){"use strict";var r=n(201),a=n.n(r).a.create({baseURL:"https://immersiv.herokuapp.com/api",withCredentials:!0});a.interceptors.request.use((function(e){var t=JSON.parse(localStorage.getItem("token"));return t&&(e.headers["auth-token"]=t),e}),(function(e){return Promise.reject(e)})),t.a=a},69:function(e,t,n){"use strict";var r=n(44),a=n.n(r),s=n(59),c=n(145),i=n(146),o=n(43),u=function(){function e(){Object(c.a)(this,e)}return Object(i.a)(e,[{key:"login",value:function(){var e=Object(s.a)(a.a.mark((function e(t,n){var r,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.post("/auth/login",{email:t,password:n});case 2:return r=e.sent,s=r.data,e.abrupt("return",s);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"googleLogin",value:function(){var e=Object(s.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.post("/auth/google",{token:t});case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"logout",value:function(){localStorage.removeItem("user"),localStorage.removeItem("token"),localStorage.removeItem("expiresAt")}},{key:"forgotPassword",value:function(e){return o.a.post("/auth/forgot-password",{email:e})}},{key:"checkToken",value:function(e,t){return o.a.post("auth/check-token",{token:e,email:t})}},{key:"resetPassword",value:function(e,t,n,r){return o.a.post("auth/reset-password",{token:e,email:t,password:n,password2:r})}},{key:"register",value:function(e,t,n){return o.a.post("auth/signup",{username:e,email:t,password:n})}},{key:"getCurrentUser",value:function(){return o.a.get("/users/profile")}}]),e}();t.a=new u},70:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return p}));var r=n(6),a=n(47),s=n(44),c=n.n(s),i=n(59),o=n(0),u=n(43),l=n(81),j=function(e){var t=e.children,n=p(),r=n.setIsLoggedIn,a=n.setUserData,s=n.setAuthData,j=n.isLoggedIn;return Object(o.useMemo)((function(){j&&u.a.interceptors.response.use((function(e){return e}),function(){var e=Object(i.a)(c.a.mark((function e(t){var n,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.config,401!==t.response.status||"/auth/refresh-token"!==n.url){e.next=3;break}return e.abrupt("return",new Promise((function(e,n){r(!1),s(null),a(null),l.a.push("/login"),n(t)})));case 3:if(401!==t.response.status||n._retry){e.next=20;break}return e.prev=4,n._retry=!0,e.next=8,u.a.post("/auth/refresh-token");case 8:return i=e.sent,localStorage.setItem("token",JSON.stringify(i.data.token)),e.abrupt("return",Object(u.a)(n));case 13:e.prev=13,e.t0=e.catch(4),localStorage.removeItem("token"),r(!1),s(null),a(null),l.a.push("/login");case 20:return e.abrupt("return",Promise.reject(t));case 21:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}())}),[j,s,r,a]),t},b=n(69),d=Object(o.createContext)(),h=function(e){var t=e.children,n=Object(o.useState)({token:""}),s=Object(a.a)(n,2),c=s[0],i=s[1],u=Object(o.useState)(!1),l=Object(a.a)(u,2),h=l[0],p=l[1];Object(o.useEffect)((function(){localStorage.getItem("token")&&(p(!0),i(JSON.parse(localStorage.getItem("token"))))}),[]);return Object(r.jsx)(d.Provider,{value:{setUserState:function(e){return function(e){var t=e.token;p(!0),i({token:t}),localStorage.setItem("token",JSON.stringify(t))}(e)},logout:function(){i(null),p(!1),b.a.logout()},isLoggedIn:h,setIsLoggedIn:p,authData:c,setAuthData:i},children:Object(r.jsx)(j,{children:t})})},p=function(){var e=Object(o.useContext)(d);if(void 0===e)throw new Error("useUser must be used within UserProvider");return e}},81:function(e,t,n){"use strict";var r=n(202);t.a=Object(r.a)()},88:function(e,t,n){"use strict";var r=n(6),a=(n(163),n(0),n(104));t.a=function(e){var t=e.children,n=e.title,s=e.loading,c=e.description,i=e.isProject;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(a.a,{children:[Object(r.jsxs)("title",{children:[n||"Home"," | IMMERSIV "]}),Object(r.jsx)("meta",{name:"description",content:c||"Ecommerce store built with React, Node, Express and Postgres"})]}),s?null:Object(r.jsx)("div",{style:{flex:1,display:i?"flex":"block"},children:t})]})}}},[[399,4,5]]]);
//# sourceMappingURL=main.d68fb2d6.chunk.js.map